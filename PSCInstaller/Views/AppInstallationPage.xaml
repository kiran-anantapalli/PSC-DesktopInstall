<Page x:Class="PSCInstaller.Views.AppInstallationPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:vms="clr-namespace:PSCInstaller.ViewModels" 
      xmlns:converters="clr-namespace:PSCInstaller.Converters" 
      mc:Ignorable="d"
      d:DataContext="{d:DesignInstance vms:AppInstallationViewModel, d:IsDesignTimeCreatable=True}"
      d:DesignHeight="350" d:DesignWidth="525"
	  Title="Application Installation">
    <Page.Resources>
        <converters:ProgressToEnabledConverter x:Key="progressToEnabledConverter" />
        <converters:BoolToNotBoolConverter x:Key="boolToNotBoolConverter" />
    </Page.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        
        <TextBlock Grid.Row="0" HorizontalAlignment="Center" Text="Installing Application Data" 
                   FontFamily="{StaticResource GillSansBookFontFamily}"
                   FontSize="30"
                   Margin="10 10 10 0"
                   Foreground="White" TextWrapping="Wrap" TextAlignment="Center"/>

        <ProgressBar x:Name="progress" Grid.Row="1" Margin="10" Maximum="100" Minimum="0" Value="{Binding Progress}"/>

        <ListView Grid.Row="2" ItemsSource="{Binding Events}" Margin="10">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding InstallationEventTimeStamp}"/>
                        <TextBlock Margin="20,0,0,0" Text="{Binding InstallationEventMessage}"/>
                    </StackPanel>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
        
        <StackPanel Grid.Row="3" VerticalAlignment="Bottom" HorizontalAlignment="Right" >

            <Button x:Name="NextButton"  Padding="10" Content="Next" Width="100" VerticalAlignment="Bottom" HorizontalAlignment="Right" 
                Command="{Binding NextCommand}"
                Style="{StaticResource StartPageButtonStyle}"
                ContentTemplate="{StaticResource NextIcon}"
                IsEnabled="{Binding ElementName=progress, Path=Value, Mode=TwoWay, Converter={StaticResource progressToEnabledConverter}}" />
            <Rectangle Height="30" Width="100" RenderTransformOrigin=".5, .5" 
                       RenderTransform="{StaticResource VerticalFlipTransformGroup}" 
                       OpacityMask="{StaticResource VerticalTransparentGradient}" >
                <Rectangle.Fill>
                    <VisualBrush Visual="{Binding ElementName=NextButton}"></VisualBrush>
                </Rectangle.Fill>
            </Rectangle>
        </StackPanel>
        
        <StackPanel Grid.Row="3" VerticalAlignment="Bottom" HorizontalAlignment="Left" >
                <Button x:Name="PreviousButton"  Content="Previous" Width="100"
                    Command="{Binding PreviousCommand}" 
                    Style="{StaticResource StartPageButtonStyle}" 
                    ContentTemplate="{StaticResource PreviousIcon}"
                    IsEnabled="{Binding IsInProgress, Converter={StaticResource boolToNotBoolConverter}}">

                </Button>
            <Rectangle Height="30" Width="100" RenderTransformOrigin=".5, .5" 
                       RenderTransform="{StaticResource VerticalFlipTransformGroup}" 
                       OpacityMask="{StaticResource VerticalTransparentGradient}" >
                <Rectangle.Fill>
                    <VisualBrush Visual="{Binding ElementName=PreviousButton}"></VisualBrush>
                </Rectangle.Fill>
            </Rectangle>
        </StackPanel>

    </Grid>
</Page>
